# Form implementation generated from reading ui file 'StatsOffer_Window.ui'
#
# Created by: PyQt6 UI code generator 6.4.1
#
# WARNING: Any manual changes made to this file will be lost when pyuic6 is
# run again.  Do not edit this file unless you know what you are doing.

from PyQt6 import QtCore, QtGui, QtWidgets
import psycopg2
from config import config
import pandas as pd
import os
from datetime import *

basedir = r"\\ERP-EIPSA-DATOS\DATOS\Comunes\EIPSA-ERP"


class Ui_StatsOffer_Window(QtWidgets.QMainWindow):
    """
    UI class for the Stats Offer window.
    """
    def __init__(self):
        """
        Initializes the Ui_StatsOffer_Window.
        """
        super().__init__()
        self.setupUi(self)

    def setupUi(self, StatsOffer_Window):
        """
        Sets up the user interface for the StatsOffer_Window.

        Args:
            StatsOffer_Window (QtWidgets.QMainWindow): The main window for the UI setup.
        """
        StatsOffer_Window.setObjectName("StatsOffer_Window")
        StatsOffer_Window.resize(845, 590)
        StatsOffer_Window.setMinimumSize(QtCore.QSize(500, 300))
        icon = QtGui.QIcon()
        icon.addPixmap(QtGui.QPixmap(os.path.abspath(os.path.join(basedir, "Resources/Iconos/icon.ico"))), QtGui.QIcon.Mode.Normal, QtGui.QIcon.State.Off)
        StatsOffer_Window.setWindowIcon(icon)
        StatsOffer_Window.setStyleSheet("QWidget {\n"
"background-color: rgb(255, 255, 255);\n"
"}\n"
"\n"
".QFrame {\n"
"    border: 2px solid black;\n"
"}\n"
"\n"
"QPushButton {\n"
"background-color: #33bdef;\n"
"  border: 1px solid transparent;\n"
"  border-radius: 3px;\n"
"  color: #fff;\n"
"  font-family: -apple-system,system-ui,\"Segoe UI\",\"Liberation Sans\",sans-serif;\n"
"  font-size: 15px;\n"
"  font-weight: 800;\n"
"  line-height: 1.15385;\n"
"  margin: 0;\n"
"  outline: none;\n"
"  padding: 8px .8em;\n"
"  text-align: center;\n"
"  text-decoration: none;\n"
"  vertical-align: baseline;\n"
"  white-space: nowrap;\n"
"}\n"
"\n"
"QPushButton:hover {\n"
"    background-color: #019ad2;\n"
"    border-color: rgb(0, 0, 0);\n"
"}\n"
"\n"
"QPushButton:focus {\n"
"    background-color: #019ad2;\n"
"    border-color: rgb(0, 0, 0);\n"
"}\n"
"\n"
"QPushButton:pressed {\n"
"    background-color: rgb(1, 140, 190);\n"
"    border-color: rgb(255, 255, 255)\n"
"}\n"
"\n"
"QPushButton:focus:pressed {\n"
"    background-color: rgb(1, 140, 190);\n"
"    border-color: rgb(255, 255, 255);\n"
"}")
        self.centralwidget = QtWidgets.QWidget(parent=StatsOffer_Window)
        self.centralwidget.setObjectName("centralwidget")
        self.gridLayout = QtWidgets.QGridLayout(self.centralwidget)
        self.gridLayout.setObjectName("gridLayout")
        self.frame = QtWidgets.QFrame(parent=self.centralwidget)
        self.frame.setFrameShape(QtWidgets.QFrame.Shape.StyledPanel)
        self.frame.setFrameShadow(QtWidgets.QFrame.Shadow.Raised)
        self.frame.setObjectName("frame")
        self.gridLayout_2 = QtWidgets.QGridLayout(self.frame)
        self.gridLayout_2.setVerticalSpacing(10)
        self.gridLayout_2.setObjectName("gridLayout_2")
        self.label_Commercial= QtWidgets.QLabel(parent=self.frame)
        self.label_Commercial.setMinimumSize(QtCore.QSize(90, 25))
        self.label_Commercial.setMaximumSize(QtCore.QSize(90, 25))
        font = QtGui.QFont()
        font.setPointSize(11)
        font.setBold(True)
        self.label_Commercial.setFont(font)
        self.label_Commercial.setObjectName("label_Commercial")
        self.gridLayout_2.addWidget(self.label_Commercial, 1, 0, 1, 1)
        self.Commercial_QueryStats = QtWidgets.QComboBox(parent=self.frame)
        self.Commercial_QueryStats.setMinimumSize(QtCore.QSize(120, 25))
        self.Commercial_QueryStats.setMaximumSize(QtCore.QSize(120, 25))
        font = QtGui.QFont()
        font.setPointSize(10)
        self.Commercial_QueryStats.setFont(font)
        self.Commercial_QueryStats.setObjectName("Commercial_QueryStats")
        self.gridLayout_2.addWidget(self.Commercial_QueryStats, 1, 1, 1, 1)
        self.label_Year= QtWidgets.QLabel(parent=self.frame)
        self.label_Year.setMinimumSize(QtCore.QSize(90, 25))
        self.label_Year.setMaximumSize(QtCore.QSize(90, 25))
        font = QtGui.QFont()
        font.setPointSize(11)
        font.setBold(True)
        self.label_Year.setFont(font)
        self.label_Year.setObjectName("label_Year")
        self.gridLayout_2.addWidget(self.label_Year, 1, 2, 1, 1)
        self.Year_QueryStats = QtWidgets.QLineEdit(parent=self.frame)
        self.Year_QueryStats.setMinimumSize(QtCore.QSize(120, 25))
        self.Year_QueryStats.setMaximumSize(QtCore.QSize(120, 25))
        font = QtGui.QFont()
        font.setPointSize(10)
        self.Year_QueryStats.setFont(font)
        self.Year_QueryStats.setObjectName("Year_QueryStats")
        self.gridLayout_2.addWidget(self.Year_QueryStats, 1, 3, 1, 1)
        self.label_Total= QtWidgets.QLabel(parent=self.frame)
        self.label_Total.setMinimumSize(QtCore.QSize(90, 25))
        # self.label_Total.setMaximumSize(QtCore.QSize(90, 25))
        font = QtGui.QFont()
        font.setPointSize(11)
        font.setBold(True)
        self.label_Total.setFont(font)
        self.label_Total.setObjectName("label_Total")
        self.gridLayout_2.addWidget(self.label_Total, 2, 0, 1, 2)
        self.Total_QueryStats = QtWidgets.QLineEdit(parent=self.frame)
        self.Total_QueryStats.setMinimumSize(QtCore.QSize(120, 25))
        self.Total_QueryStats.setMaximumSize(QtCore.QSize(120, 25))
        font = QtGui.QFont()
        font.setPointSize(10)
        self.Total_QueryStats.setFont(font)
        self.Total_QueryStats.setReadOnly(True)
        self.Total_QueryStats.setObjectName("Total_QueryStats")
        self.gridLayout_2.addWidget(self.Total_QueryStats, 2, 2, 1, 1)
        self.line = QtWidgets.QFrame(parent=self.frame)
        self.line.setObjectName("line")
        self.line.setFrameShadow(QtWidgets.QFrame.Shadow.Plain)
        self.line.setLineWidth(1)
        self.line.setFrameShape(QtWidgets.QFrame.Shape.HLine)
        self.gridLayout_2.addWidget(self.line, 3, 0, 1, 4)
        self.label_Reg= QtWidgets.QLabel(parent=self.frame)
        self.label_Reg.setMinimumSize(QtCore.QSize(150, 25))
        # self.label_Reg.setMaximumSize(QtCore.QSize(150, 25))
        font = QtGui.QFont()
        font.setPointSize(11)
        font.setBold(True)
        self.label_Reg.setFont(font)
        self.label_Reg.setObjectName("label_Reg")
        self.gridLayout_2.addWidget(self.label_Reg, 4, 0, 1, 2)
        self.Reg_QueryStats = QtWidgets.QLineEdit(parent=self.frame)
        self.Reg_QueryStats.setMinimumSize(QtCore.QSize(120, 25))
        self.Reg_QueryStats.setMaximumSize(QtCore.QSize(120, 25))
        font = QtGui.QFont()
        font.setPointSize(10)
        self.Reg_QueryStats.setFont(font)
        self.Reg_QueryStats.setReadOnly(True)
        self.Reg_QueryStats.setObjectName("Reg_QueryStats")
        self.gridLayout_2.addWidget(self.Reg_QueryStats, 4, 2, 1, 1)
        self.show_reg = QtWidgets.QPushButton(parent=self.frame)
        self.show_reg.setMinimumSize(QtCore.QSize(25, 25))
        self.show_reg.setMaximumSize(QtCore.QSize(25, 25))
        self.show_reg.setFocusPolicy(QtCore.Qt.FocusPolicy.NoFocus)
        self.show_reg.setStyleSheet("\n"
        "QPushButton {\n"
        "background-color: #33bdef;\n"
        "  border: 1px solid transparent;\n"
        "  border-radius: 3px;\n"
        "  color: #fff;\n"
        "  font-family: -apple-system,system-ui,\"Segoe UI\",\"Liberation Sans\",sans-serif;\n"
        "  font-weight: 800;\n"
        "  line-height: 1.15385;\n"
        "  margin: 0;\n"
        "  outline: none;\n"
        "  padding: 8px .8em;\n"
        "  text-align: center;\n"
        "  text-decoration: none;\n"
        "  vertical-align: baseline;\n"
        "  white-space: nowrap;\n"
        "}\n"
        "\n"
        "QPushButton:hover {\n"
        "    background-color: #019ad2;\n"
        "    border-color: rgb(0, 0, 0);\n"
        "}\n"
        "\n"
        "QPushButton:pressed {\n"
        "    background-color: rgb(1, 140, 190);\n"
        "    border-color: rgb(255, 255, 255);\n"
        "}\n"
        "\n"
        "QPushButton:focus{\n"
        "    background-color: #019ad2;\n"
        "    border-color: rgb(0, 0, 0);\n"
        "}\n"
        "\n"
        "QPushButton:focus:pressed {\n"
        "    background-color: rgb(1, 140, 190);\n"
        "    border-color: rgb(255, 255, 255);\n"
        "}")
        self.show_reg.setObjectName("show_reg")
        icon6 = QtGui.QIcon()
        icon6.addPixmap(QtGui.QPixmap(os.path.abspath(os.path.join(basedir, "Resources/Iconos/Eye_White.png"))), QtGui.QIcon.Mode.Normal, QtGui.QIcon.State.Off)
        self.show_reg.setIcon(icon6)
        self.show_reg.setIconSize(QtCore.QSize(20, 20))
        self.gridLayout_2.addWidget(self.show_reg, 4, 3, 1, 1)
        self.label_Pres= QtWidgets.QLabel(parent=self.frame)
        self.label_Pres.setMinimumSize(QtCore.QSize(150, 25))
        # self.label_Adj.setMaximumSize(QtCore.QSize(150, 25))
        font = QtGui.QFont()
        font.setPointSize(11)
        font.setBold(True)
        self.label_Pres.setFont(font)
        self.label_Pres.setObjectName("label_Pres")
        self.gridLayout_2.addWidget(self.label_Pres, 5, 0, 1, 2)
        self.Pres_QueryStats = QtWidgets.QLineEdit(parent=self.frame)
        self.Pres_QueryStats.setMinimumSize(QtCore.QSize(120, 25))
        self.Pres_QueryStats.setMaximumSize(QtCore.QSize(120, 25))
        font = QtGui.QFont()
        font.setPointSize(10)
        self.Pres_QueryStats.setFont(font)
        self.Pres_QueryStats.setReadOnly(True)
        self.Pres_QueryStats.setObjectName("Pres_QueryStats")
        self.gridLayout_2.addWidget(self.Pres_QueryStats, 5, 2, 1, 1)
        self.show_pres = QtWidgets.QPushButton(parent=self.frame)
        self.show_pres.setMinimumSize(QtCore.QSize(25, 25))
        self.show_pres.setMaximumSize(QtCore.QSize(25, 25))
        self.show_pres.setFocusPolicy(QtCore.Qt.FocusPolicy.NoFocus)
        self.show_pres.setStyleSheet("\n"
        "QPushButton {\n"
        "background-color: #33bdef;\n"
        "  border: 1px solid transparent;\n"
        "  border-radius: 3px;\n"
        "  color: #fff;\n"
        "  font-family: -apple-system,system-ui,\"Segoe UI\",\"Liberation Sans\",sans-serif;\n"
        "  font-weight: 800;\n"
        "  line-height: 1.15385;\n"
        "  margin: 0;\n"
        "  outline: none;\n"
        "  padding: 8px .8em;\n"
        "  text-align: center;\n"
        "  text-decoration: none;\n"
        "  vertical-align: baseline;\n"
        "  white-space: nowrap;\n"
        "}\n"
        "\n"
        "QPushButton:hover {\n"
        "    background-color: #019ad2;\n"
        "    border-color: rgb(0, 0, 0);\n"
        "}\n"
        "\n"
        "QPushButton:pressed {\n"
        "    background-color: rgb(1, 140, 190);\n"
        "    border-color: rgb(255, 255, 255);\n"
        "}\n"
        "\n"
        "QPushButton:focus{\n"
        "    background-color: #019ad2;\n"
        "    border-color: rgb(0, 0, 0);\n"
        "}\n"
        "\n"
        "QPushButton:focus:pressed {\n"
        "    background-color: rgb(1, 140, 190);\n"
        "    border-color: rgb(255, 255, 255);\n"
        "}")
        self.show_pres.setObjectName("show_pres")
        icon6 = QtGui.QIcon()
        icon6.addPixmap(QtGui.QPixmap(os.path.abspath(os.path.join(basedir, "Resources/Iconos/Eye_White.png"))), QtGui.QIcon.Mode.Normal, QtGui.QIcon.State.Off)
        self.show_pres.setIcon(icon6)
        self.show_pres.setIconSize(QtCore.QSize(20, 20))
        self.gridLayout_2.addWidget(self.show_pres, 5, 3, 1, 1)
        self.label_Adj= QtWidgets.QLabel(parent=self.frame)
        self.label_Adj.setMinimumSize(QtCore.QSize(150, 25))
        # self.label_Adj.setMaximumSize(QtCore.QSize(150, 25))
        font = QtGui.QFont()
        font.setPointSize(11)
        font.setBold(True)
        self.label_Adj.setFont(font)
        self.label_Adj.setObjectName("label_Adj")
        self.gridLayout_2.addWidget(self.label_Adj, 6, 0, 1, 2)
        self.Adj_QueryStats = QtWidgets.QLineEdit(parent=self.frame)
        self.Adj_QueryStats.setMinimumSize(QtCore.QSize(120, 25))
        self.Adj_QueryStats.setMaximumSize(QtCore.QSize(120, 25))
        font = QtGui.QFont()
        font.setPointSize(10)
        self.Adj_QueryStats.setFont(font)
        self.Adj_QueryStats.setReadOnly(True)
        self.Adj_QueryStats.setObjectName("Adj_QueryStats")
        self.gridLayout_2.addWidget(self.Adj_QueryStats, 6, 2, 1, 1)
        self.show_adj = QtWidgets.QPushButton(parent=self.frame)
        self.show_adj.setMinimumSize(QtCore.QSize(25, 25))
        self.show_adj.setMaximumSize(QtCore.QSize(25, 25))
        self.show_adj.setFocusPolicy(QtCore.Qt.FocusPolicy.NoFocus)
        self.show_adj.setStyleSheet("\n"
        "QPushButton {\n"
        "background-color: #33bdef;\n"
        "  border: 1px solid transparent;\n"
        "  border-radius: 3px;\n"
        "  color: #fff;\n"
        "  font-family: -apple-system,system-ui,\"Segoe UI\",\"Liberation Sans\",sans-serif;\n"
        "  font-weight: 800;\n"
        "  line-height: 1.15385;\n"
        "  margin: 0;\n"
        "  outline: none;\n"
        "  padding: 8px .8em;\n"
        "  text-align: center;\n"
        "  text-decoration: none;\n"
        "  vertical-align: baseline;\n"
        "  white-space: nowrap;\n"
        "}\n"
        "\n"
        "QPushButton:hover {\n"
        "    background-color: #019ad2;\n"
        "    border-color: rgb(0, 0, 0);\n"
        "}\n"
        "\n"
        "QPushButton:pressed {\n"
        "    background-color: rgb(1, 140, 190);\n"
        "    border-color: rgb(255, 255, 255);\n"
        "}\n"
        "\n"
        "QPushButton:focus{\n"
        "    background-color: #019ad2;\n"
        "    border-color: rgb(0, 0, 0);\n"
        "}\n"
        "\n"
        "QPushButton:focus:pressed {\n"
        "    background-color: rgb(1, 140, 190);\n"
        "    border-color: rgb(255, 255, 255);\n"
        "}")
        self.show_adj.setObjectName("show_adj")
        icon6 = QtGui.QIcon()
        icon6.addPixmap(QtGui.QPixmap(os.path.abspath(os.path.join(basedir, "Resources/Iconos/Eye_White.png"))), QtGui.QIcon.Mode.Normal, QtGui.QIcon.State.Off)
        self.show_adj.setIcon(icon6)
        self.show_adj.setIconSize(QtCore.QSize(20, 20))
        self.gridLayout_2.addWidget(self.show_adj, 6, 3, 1, 1)
        self.label_Perd= QtWidgets.QLabel(parent=self.frame)
        self.label_Perd.setMinimumSize(QtCore.QSize(150, 25))
        # self.label_Perd.setMaximumSize(QtCore.QSize(150, 25))
        font = QtGui.QFont()
        font.setPointSize(11)
        font.setBold(True)
        self.label_Perd.setFont(font)
        self.label_Perd.setObjectName("label_Perd")
        self.gridLayout_2.addWidget(self.label_Perd, 7, 0, 1, 2)
        self.Perd_QueryStats = QtWidgets.QLineEdit(parent=self.frame)
        self.Perd_QueryStats.setMinimumSize(QtCore.QSize(120, 25))
        self.Perd_QueryStats.setMaximumSize(QtCore.QSize(120, 25))
        font = QtGui.QFont()
        font.setPointSize(10)
        self.Perd_QueryStats.setFont(font)
        self.Perd_QueryStats.setReadOnly(True)
        self.Perd_QueryStats.setObjectName("Perd_QueryStats")
        self.gridLayout_2.addWidget(self.Perd_QueryStats, 7, 2, 1, 1)
        self.show_perd = QtWidgets.QPushButton(parent=self.frame)
        self.show_perd.setMinimumSize(QtCore.QSize(25, 25))
        self.show_perd.setMaximumSize(QtCore.QSize(25, 25))
        self.show_perd.setFocusPolicy(QtCore.Qt.FocusPolicy.NoFocus)
        self.show_perd.setStyleSheet("\n"
        "QPushButton {\n"
        "background-color: #33bdef;\n"
        "  border: 1px solid transparent;\n"
        "  border-radius: 3px;\n"
        "  color: #fff;\n"
        "  font-family: -apple-system,system-ui,\"Segoe UI\",\"Liberation Sans\",sans-serif;\n"
        "  font-weight: 800;\n"
        "  line-height: 1.15385;\n"
        "  margin: 0;\n"
        "  outline: none;\n"
        "  padding: 8px .8em;\n"
        "  text-align: center;\n"
        "  text-decoration: none;\n"
        "  vertical-align: baseline;\n"
        "  white-space: nowrap;\n"
        "}\n"
        "\n"
        "QPushButton:hover {\n"
        "    background-color: #019ad2;\n"
        "    border-color: rgb(0, 0, 0);\n"
        "}\n"
        "\n"
        "QPushButton:pressed {\n"
        "    background-color: rgb(1, 140, 190);\n"
        "    border-color: rgb(255, 255, 255);\n"
        "}\n"
        "\n"
        "QPushButton:focus{\n"
        "    background-color: #019ad2;\n"
        "    border-color: rgb(0, 0, 0);\n"
        "}\n"
        "\n"
        "QPushButton:focus:pressed {\n"
        "    background-color: rgb(1, 140, 190);\n"
        "    border-color: rgb(255, 255, 255);\n"
        "}")
        self.show_perd.setObjectName("show_perd")
        icon6 = QtGui.QIcon()
        icon6.addPixmap(QtGui.QPixmap(os.path.abspath(os.path.join(basedir, "Resources/Iconos/Eye_White.png"))), QtGui.QIcon.Mode.Normal, QtGui.QIcon.State.Off)
        self.show_perd.setIcon(icon6)
        self.show_perd.setIconSize(QtCore.QSize(20, 20))
        self.gridLayout_2.addWidget(self.show_perd, 7, 3, 1, 1)
        self.label_Dec= QtWidgets.QLabel(parent=self.frame)
        self.label_Dec.setMinimumSize(QtCore.QSize(150, 25))
        # self.label_Dec.setMaximumSize(QtCore.QSize(150, 25))
        font = QtGui.QFont()
        font.setPointSize(11)
        font.setBold(True)
        self.label_Dec.setFont(font)
        self.label_Dec.setObjectName("label_Dec")
        self.gridLayout_2.addWidget(self.label_Dec, 8, 0, 1, 2)
        self.Dec_QueryStats = QtWidgets.QLineEdit(parent=self.frame)
        self.Dec_QueryStats.setMinimumSize(QtCore.QSize(120, 25))
        self.Dec_QueryStats.setMaximumSize(QtCore.QSize(120, 25))
        font = QtGui.QFont()
        font.setPointSize(10)
        self.Dec_QueryStats.setReadOnly(True)
        self.Dec_QueryStats.setFont(font)
        self.Dec_QueryStats.setObjectName("Dec_QueryStats")
        self.gridLayout_2.addWidget(self.Dec_QueryStats, 8, 2, 1, 1)
        self.show_dec = QtWidgets.QPushButton(parent=self.frame)
        self.show_dec.setMinimumSize(QtCore.QSize(25, 25))
        self.show_dec.setMaximumSize(QtCore.QSize(25, 25))
        self.show_dec.setFocusPolicy(QtCore.Qt.FocusPolicy.NoFocus)
        self.show_dec.setStyleSheet("\n"
        "QPushButton {\n"
        "background-color: #33bdef;\n"
        "  border: 1px solid transparent;\n"
        "  border-radius: 3px;\n"
        "  color: #fff;\n"
        "  font-family: -apple-system,system-ui,\"Segoe UI\",\"Liberation Sans\",sans-serif;\n"
        "  font-weight: 800;\n"
        "  line-height: 1.15385;\n"
        "  margin: 0;\n"
        "  outline: none;\n"
        "  padding: 8px .8em;\n"
        "  text-align: center;\n"
        "  text-decoration: none;\n"
        "  vertical-align: baseline;\n"
        "  white-space: nowrap;\n"
        "}\n"
        "\n"
        "QPushButton:hover {\n"
        "    background-color: #019ad2;\n"
        "    border-color: rgb(0, 0, 0);\n"
        "}\n"
        "\n"
        "QPushButton:pressed {\n"
        "    background-color: rgb(1, 140, 190);\n"
        "    border-color: rgb(255, 255, 255);\n"
        "}\n"
        "\n"
        "QPushButton:focus{\n"
        "    background-color: #019ad2;\n"
        "    border-color: rgb(0, 0, 0);\n"
        "}\n"
        "\n"
        "QPushButton:focus:pressed {\n"
        "    background-color: rgb(1, 140, 190);\n"
        "    border-color: rgb(255, 255, 255);\n"
        "}")
        self.show_dec.setObjectName("show_dec")
        icon6 = QtGui.QIcon()
        icon6.addPixmap(QtGui.QPixmap(os.path.abspath(os.path.join(basedir, "Resources/Iconos/Eye_White.png"))), QtGui.QIcon.Mode.Normal, QtGui.QIcon.State.Off)
        self.show_dec.setIcon(icon6)
        self.show_dec.setIconSize(QtCore.QSize(20, 20))
        self.gridLayout_2.addWidget(self.show_dec, 8, 3, 1, 1)
        self.label_Est= QtWidgets.QLabel(parent=self.frame)
        self.label_Est.setMinimumSize(QtCore.QSize(150, 25))
        # self.label_Est.setMaximumSize(QtCore.QSize(150, 25))
        font = QtGui.QFont()
        font.setPointSize(11)
        font.setBold(True)
        self.label_Est.setFont(font)
        self.label_Est.setObjectName("label_Est")
        self.gridLayout_2.addWidget(self.label_Est, 9, 0, 1, 2)
        self.Est_QueryStats = QtWidgets.QLineEdit(parent=self.frame)
        self.Est_QueryStats.setMinimumSize(QtCore.QSize(120, 25))
        self.Est_QueryStats.setMaximumSize(QtCore.QSize(120, 25))
        font = QtGui.QFont()
        font.setPointSize(10)
        self.Est_QueryStats.setReadOnly(True)
        self.Est_QueryStats.setFont(font)
        self.Est_QueryStats.setObjectName("Est_QueryStats")
        self.gridLayout_2.addWidget(self.Est_QueryStats, 9, 2, 1, 1)
        self.show_est = QtWidgets.QPushButton(parent=self.frame)
        self.show_est.setMinimumSize(QtCore.QSize(25, 25))
        self.show_est.setMaximumSize(QtCore.QSize(25, 25))
        self.show_est.setFocusPolicy(QtCore.Qt.FocusPolicy.NoFocus)
        self.show_est.setStyleSheet("\n"
        "QPushButton {\n"
        "background-color: #33bdef;\n"
        "  border: 1px solid transparent;\n"
        "  border-radius: 3px;\n"
        "  color: #fff;\n"
        "  font-family: -apple-system,system-ui,\"Segoe UI\",\"Liberation Sans\",sans-serif;\n"
        "  font-weight: 800;\n"
        "  line-height: 1.15385;\n"
        "  margin: 0;\n"
        "  outline: none;\n"
        "  padding: 8px .8em;\n"
        "  text-align: center;\n"
        "  text-decoration: none;\n"
        "  vertical-align: baseline;\n"
        "  white-space: nowrap;\n"
        "}\n"
        "\n"
        "QPushButton:hover {\n"
        "    background-color: #019ad2;\n"
        "    border-color: rgb(0, 0, 0);\n"
        "}\n"
        "\n"
        "QPushButton:pressed {\n"
        "    background-color: rgb(1, 140, 190);\n"
        "    border-color: rgb(255, 255, 255);\n"
        "}\n"
        "\n"
        "QPushButton:focus{\n"
        "    background-color: #019ad2;\n"
        "    border-color: rgb(0, 0, 0);\n"
        "}\n"
        "\n"
        "QPushButton:focus:pressed {\n"
        "    background-color: rgb(1, 140, 190);\n"
        "    border-color: rgb(255, 255, 255);\n"
        "}")
        self.show_est.setObjectName("show_est")
        icon6 = QtGui.QIcon()
        icon6.addPixmap(QtGui.QPixmap(os.path.abspath(os.path.join(basedir, "Resources/Iconos/Eye_White.png"))), QtGui.QIcon.Mode.Normal, QtGui.QIcon.State.Off)
        self.show_est.setIcon(icon6)
        self.show_est.setIconSize(QtCore.QSize(20, 20))
        self.gridLayout_2.addWidget(self.show_est, 9, 3, 1, 1)
        self.label_Rec= QtWidgets.QLabel(parent=self.frame)
        self.label_Rec.setMinimumSize(QtCore.QSize(150, 25))
        # self.label_Rec.setMaximumSize(QtCore.QSize(150, 25))
        font = QtGui.QFont()
        font.setPointSize(11)
        font.setBold(True)
        self.label_Rec.setFont(font)
        self.label_Rec.setObjectName("label_Rec")
        self.gridLayout_2.addWidget(self.label_Rec, 10, 0, 1, 2)
        self.Rec_QueryStats = QtWidgets.QLineEdit(parent=self.frame)
        self.Rec_QueryStats.setMinimumSize(QtCore.QSize(120, 25))
        self.Rec_QueryStats.setMaximumSize(QtCore.QSize(120, 25))
        font = QtGui.QFont()
        font.setPointSize(10)
        self.Rec_QueryStats.setReadOnly(True)
        self.Rec_QueryStats.setFont(font)
        self.Rec_QueryStats.setObjectName("Rec_QueryStats")
        self.gridLayout_2.addWidget(self.Rec_QueryStats, 10, 2, 1, 1)
        self.show_rec = QtWidgets.QPushButton(parent=self.frame)
        self.show_rec.setMinimumSize(QtCore.QSize(25, 25))
        self.show_rec.setMaximumSize(QtCore.QSize(25, 25))
        self.show_rec.setFocusPolicy(QtCore.Qt.FocusPolicy.NoFocus)
        self.show_rec.setStyleSheet("\n"
        "QPushButton {\n"
        "background-color: #33bdef;\n"
        "  border: 1px solid transparent;\n"
        "  border-radius: 3px;\n"
        "  color: #fff;\n"
        "  font-family: -apple-system,system-ui,\"Segoe UI\",\"Liberation Sans\",sans-serif;\n"
        "  font-weight: 800;\n"
        "  line-height: 1.15385;\n"
        "  margin: 0;\n"
        "  outline: none;\n"
        "  padding: 8px .8em;\n"
        "  text-align: center;\n"
        "  text-decoration: none;\n"
        "  vertical-align: baseline;\n"
        "  white-space: nowrap;\n"
        "}\n"
        "\n"
        "QPushButton:hover {\n"
        "    background-color: #019ad2;\n"
        "    border-color: rgb(0, 0, 0);\n"
        "}\n"
        "\n"
        "QPushButton:pressed {\n"
        "    background-color: rgb(1, 140, 190);\n"
        "    border-color: rgb(255, 255, 255);\n"
        "}\n"
        "\n"
        "QPushButton:focus{\n"
        "    background-color: #019ad2;\n"
        "    border-color: rgb(0, 0, 0);\n"
        "}\n"
        "\n"
        "QPushButton:focus:pressed {\n"
        "    background-color: rgb(1, 140, 190);\n"
        "    border-color: rgb(255, 255, 255);\n"
        "}")
        self.show_rec.setObjectName("show_rec")
        icon6 = QtGui.QIcon()
        icon6.addPixmap(QtGui.QPixmap(os.path.abspath(os.path.join(basedir, "Resources/Iconos/Eye_White.png"))), QtGui.QIcon.Mode.Normal, QtGui.QIcon.State.Off)
        self.show_rec.setIcon(icon6)
        self.show_rec.setIconSize(QtCore.QSize(20, 20))
        self.gridLayout_2.addWidget(self.show_rec, 10, 3, 1, 1)
        self.gridLayout.addWidget(self.frame, 0, 0, 1, 1)
        StatsOffer_Window.setCentralWidget(self.centralwidget)
        self.menubar = QtWidgets.QMenuBar(parent=StatsOffer_Window)
        self.menubar.setGeometry(QtCore.QRect(0, 0, 845, 22))
        self.menubar.setObjectName("menubar")
        StatsOffer_Window.setMenuBar(self.menubar)
        self.statusbar = QtWidgets.QStatusBar(parent=StatsOffer_Window)
        self.statusbar.setObjectName("statusbar")
        StatsOffer_Window.setStatusBar(self.statusbar)


        commands_queryusers= ("""
                        SELECT users_data.initials."initials", users_data.registration."username"
                        FROM users_data.registration
                        INNER JOIN users_data.initials ON (users_data.registration."username" = users_data.initials."username")
                        WHERE users_data.registration."profile" = 'Comercial'
                        """)

        conn = None
        try:
        # read the connection parameters
            params = config()
        # connect to the PostgreSQL server
            conn = psycopg2.connect(**params)
            cur = conn.cursor()
        # execution of commands
            cur.execute(commands_queryusers)
            results=cur.fetchall()

            list_users = [x[0] for x in results]

            self.dict_users = {x[0]: x[1] for x in results}

        # close communication with the PostgreSQL database server
            cur.close()
        # commit the changes
            conn.commit()
        except (Exception, psycopg2.DatabaseError) as error:
            print(error)
            dlg = QtWidgets.QMessageBox()
            new_icon = QtGui.QIcon()
            new_icon.addPixmap(QtGui.QPixmap(os.path.abspath(os.path.join(basedir, "Resources/Iconos/icon.ico"))), QtGui.QIcon.Mode.Normal, QtGui.QIcon.State.Off)
            dlg.setWindowIcon(new_icon)
            dlg.setWindowTitle("ERP EIPSA")
            dlg.setText("Ha ocurrido el siguiente error:\n"
                        + str(error))
            dlg.setIcon(QtWidgets.QMessageBox.Icon.Critical)
            dlg.exec()
            del dlg, new_icon
        finally:
            if conn is not None:
                conn.close()

        self.Commercial_QueryStats.addItems(list_users)

        self.retranslateUi(StatsOffer_Window)
        QtCore.QMetaObject.connectSlotsByName(StatsOffer_Window)
        self.Commercial_QueryStats.currentTextChanged.connect(self.query_all_offers)
        self.Year_QueryStats.returnPressed.connect(self.query_all_offers)
        self.show_reg.clicked.connect(lambda: self.query_stats('Registrada'))
        self.show_pres.clicked.connect(lambda: self.query_stats('Presentada'))
        self.show_adj.clicked.connect(lambda: self.query_stats('Adjudicada'))
        self.show_perd.clicked.connect(lambda: self.query_stats('Perdida'))
        self.show_dec.clicked.connect(lambda: self.query_stats('Declinada'))
        self.show_est.clicked.connect(lambda: self.query_stats('Estimación'))
        self.show_rec.clicked.connect(lambda: self.query_stats('Recibida'))


# Function to translate and updates the text of various UI elements
    def retranslateUi(self, StatsOffer_Window):
        """
        Translates and updates the text of various UI elements.
        """
        _translate = QtCore.QCoreApplication.translate
        StatsOffer_Window.setWindowTitle(_translate("StatsOffer_Window", "Estadísticas Comercial"))
        self.label_Commercial.setText(_translate("StatsOffer_Window", "Comercial:"))
        self.label_Year.setText(_translate("StatsOffer_Window", "Año:"))
        self.label_Total.setText(_translate("StatsOffer_Window", "N° Ofertas Totales:"))
        self.label_Reg.setText(_translate("StatsOffer_Window", "Ofertas Registradas:"))
        self.label_Pres.setText(_translate("StatsOffer_Window", "Ofertas Presentadas:"))
        self.label_Adj.setText(_translate("StatsOffer_Window", "Ofertas Adjudicadas:"))
        self.label_Perd.setText(_translate("StatsOffer_Window", "Ofertas Perdidas:"))
        self.label_Dec.setText(_translate("StatsOffer_Window", "Ofertas Declinadas:"))
        self.label_Est.setText(_translate("StatsOffer_Window", "Ofertas Estimación:"))
        self.label_Rec.setText(_translate("StatsOffer_Window", "Ofertas Recibidas:"))


    def query_all_offers(self):
        """
        Queries the database for all offers, configures and populates tables with the query results, 
        and updates the UI accordingly. Handles potential database errors and updates the UI with appropriate messages.
        """
        initials = self.Commercial_QueryStats.currentText()
        responsible = self.dict_users[initials]
        year = self.Year_QueryStats.text() if self.Year_QueryStats.text() != '' else None

        commands_queryoffer = ("""
                        (SELECT offers."state", EXTRACT(YEAR FROM (offers."register_date")) as year_offer, users_data.initials."initials"
                        FROM offers
                        INNER JOIN users_data.initials ON (offers."responsible"=users_data.initials."username")
                        WHERE (EXTRACT(YEAR FROM offers."register_date") = %s OR %s IS NULL)
                        AND
                        offers."responsible" = %s
                        ORDER BY offers."num_offer")
                        UNION ALL
                        (SELECT received_offers."state", EXTRACT(YEAR FROM (received_offers."register_date")) as year_offer, users_data.initials."initials"
                        FROM received_offers
                        INNER JOIN users_data.initials ON (received_offers."responsible"=users_data.initials."username")
                        WHERE (EXTRACT(YEAR FROM received_offers."register_date") = %s OR %s IS NULL)
                        AND
                        received_offers."responsible" = %s
                        ORDER BY received_offers."id_offer")
                        """)

        conn = None
        try:
        # read the connection parameters
            params = config()
        # connect to the PostgreSQL server
            conn = psycopg2.connect(**params)
            cur = conn.cursor()
        # execution of commands
            cur.execute(commands_queryoffer, (year, year, responsible, year, year, responsible,))
            results=cur.fetchall()

            df_offers = pd.DataFrame(results, columns=['state', 'year', 'initials'])

            self.Total_QueryStats.setText(str(df_offers.shape[0]))
            self.Reg_QueryStats.setText(str(df_offers['state'].value_counts().get('Registrada', 0)))
            self.Pres_QueryStats.setText(str(df_offers['state'].value_counts().get('Presentada', 0)))
            self.Adj_QueryStats.setText(str(df_offers['state'].value_counts().get('Adjudicada', 0)))
            self.Perd_QueryStats.setText(str(df_offers['state'].value_counts().get('Perdida', 0)))
            self.Dec_QueryStats.setText(str(df_offers['state'].value_counts().get('Declinada', 0)))
            self.Est_QueryStats.setText(str(df_offers['state'].value_counts().get('Estimación', 0)))
            self.Rec_QueryStats.setText(str(df_offers['state'].value_counts().get('Recibida', 0)))


        # close communication with the PostgreSQL database server
            cur.close()
        # commit the changes
            conn.commit()
        except (Exception, psycopg2.DatabaseError) as error:
            print(error)
            dlg = QtWidgets.QMessageBox()
            new_icon = QtGui.QIcon()
            new_icon.addPixmap(QtGui.QPixmap(os.path.abspath(os.path.join(basedir, "Resources/Iconos/icon.ico"))), QtGui.QIcon.Mode.Normal, QtGui.QIcon.State.Off)
            dlg.setWindowIcon(new_icon)
            dlg.setWindowTitle("ERP EIPSA")
            dlg.setText("Ha ocurrido el siguiente error:\n"
                        + str(error))
            dlg.setIcon(QtWidgets.QMessageBox.Icon.Critical)
            dlg.exec()
            del dlg, new_icon
        finally:
            if conn is not None:
                conn.close()


    def query_stats(self, state):
        """
        Opens the 'OfferQueryStats' window. Sets up the UI for the user.
        
        Args:
            state (str): The current state of the offers selected.
        """
        initials = self.Commercial_QueryStats.currentText()
        responsible = self.dict_users[initials]
        year = int(self.Year_QueryStats.text()) if self.Year_QueryStats.text() != '' else None

        from OfferQueryStats_Window import Ui_QueryOfferStats_Window
        self.querystats_window=QtWidgets.QMainWindow()
        self.ui=Ui_QueryOfferStats_Window(year, responsible, state)
        self.ui.setupUi(self.querystats_window)
        self.querystats_window.show()

if __name__ == "__main__":
    import sys
    app = QtWidgets.QApplication(sys.argv)
    StatsOffer_Window = Ui_StatsOffer_Window()
    StatsOffer_Window.show()
    sys.exit(app.exec())
